<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
         "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mid.mypage.repo.OrderDAO">

  <select id="getOrderList" parameterType="string" resultType="com.mid.mypage.model.OrderVO">
    SELECT
      o.ORDER_NO as orderNo,
      o.MEM_NO as memNo,
      o.ORDER_DATE as orderDate,
      o.TOTAL_AMOUNT as totalAmount,
      o.ORDER_STATUS as orderStatus,
      o.PAY_NO as paymentMethod,
      p.PRODUCT_NAME as productName,
      p.PRODUCT_PRICE as productPrice
    FROM
      ORDERS o
      JOIN ORDERS_DETAIL od ON o.ORDER_NO = od.ORDER_NO
      JOIN PRODUCT p ON od.PRODUCT_NO = p.PRODUCT_NO
    WHERE
      o.MEM_NO = #{memNo}
    ORDER BY
      o.ORDER_DATE DESC, o.ORDER_NO DESC
  </select>

  <select id="getOrderListByMemberId" parameterType="string" resultType="com.mid.mypage.model.OrderVO">
    SELECT
      o.ORDER_NO as orderNo,
      o.MEM_NO as memNo,
      o.ORDER_DATE as orderDate,
      o.TOTAL_AMOUNT as totalAmount,
      o.ORDER_STATUS as orderStatus,
      o.DELIVERY_ADDRESS as deliveryAddress,
      o.PAY_NO as paymentMethod,
      p.PRODUCT_NAME as productName,
      p.PRODUCT_PRICE as productPrice
    FROM
      ORDERS o
      JOIN ORDERS_DETAIL od ON o.ORDER_NO = od.ORDER_NO
      JOIN PRODUCT p ON od.PRODUCT_NO = p.PRODUCT_NO
      JOIN MEMBER m ON o.MEM_NO = m.MEM_NO
    WHERE
      m.MEM_ID = #{memId}
    ORDER BY
      o.ORDER_DATE DESC, o.ORDER_NO DESC
  </select>

</mapper>
